<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Vaibhav Balloli">
<meta name="dcterms.date" content="2023-02-14">

<title>Research Recap - Folded Optimization for End-to-End Model-Based Learning: A summary</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-35WV1WKM7Q"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-35WV1WKM7Q', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  });
});
</script> 
  


<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Research Recap - Folded Optimization for End-to-End Model-Based Learning: A summary">
<meta name="twitter:description" content="Folded Optimization for End-to-End Model-Based Learning by Kotary, Dinh, and Fioretto (2023) is an exciting new paper that tackles the problem of integrating constrained optimization models/solvers…">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Research Recap</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About Me</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/vballoli"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/v_balloli"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://vballoli.github.io"><i class="bi bi-globe" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://vballoli.com"><i class="bi bi-book" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:balloli.vb@gmail.com"><i class="bi bi-envelope-open" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Folded Optimization for End-to-End Model-Based Learning: A summary</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Optimization</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Vaibhav Balloli </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 14, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#preliminaries" id="toc-preliminaries" class="nav-link active" data-scroll-target="#preliminaries">Preliminaries</a>
  <ul class="collapse">
  <li><a href="#unfolding-and-unrolling" id="toc-unfolding-and-unrolling" class="nav-link" data-scroll-target="#unfolding-and-unrolling">Unfolding and Unrolling</a></li>
  <li><a href="#analytic-differentiation" id="toc-analytic-differentiation" class="nav-link" data-scroll-target="#analytic-differentiation">Analytic Differentiation</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p><em>Folded Optimization for End-to-End Model-Based Learning</em> by <span class="citation" data-cites="kotary2023folded">Kotary, Dinh, and Fioretto (<a href="#ref-kotary2023folded" role="doc-biblioref">2023</a>)</span> is an exciting new paper that tackles the problem of integrating constrained optimization models/solvers into the neural network pipeline. For example, a scenario where the outputs of a neural network act as inputs to these solvers that output the optimal decisions. This problem has been tackled before in various forms depending on the target task and the assumptions made to relax some of the differentiability constraints(see <span class="citation" data-cites="donti2021dc3">Donti, Rolnick, and Kolter (<a href="#ref-donti2021dc3" role="doc-biblioref">2021</a>)</span>, <span class="citation" data-cites="ferber2020mipaal">Ferber et al. (<a href="#ref-ferber2020mipaal" role="doc-biblioref">2020</a>)</span>, <span class="citation" data-cites="poganvcic2020differentiation">Pogančić et al. (<a href="#ref-poganvcic2020differentiation" role="doc-biblioref">2020</a>)</span> and many more). More recently, this line of work are being turned into libraries(<span class="citation" data-cites="amos2017optnet">Amos and Kolter (<a href="#ref-amos2017optnet" role="doc-biblioref">2017</a>)</span>, <span class="citation" data-cites="pineda2022theseus">Pineda et al. (<a href="#ref-pineda2022theseus" role="doc-biblioref">2022</a>)</span>) built on top of frameworks capable of autograd like <a href="pytorch.org">PyTorch</a> for users to model their own scenarios without having to implement them from scratch. This is an important problem, especially when there a lot of tasks in various industries and applications that require decision making under non-convex constraints and uncertain data.</p>
<p>In this post, I summarize the paper by covering some preliminary concepts, present the intuition behind the contribution and go over some key takeaways from this. This paper also provides a library <code>fold-opt</code> that is yet to be open sourced, so I’ll also be covering that once that happens.</p>
<section id="preliminaries" class="level1">
<h1>Preliminaries</h1>
<p>What makes this problem difficult is the <em>lack of meaningful gradients</em> i.e.&nbsp;technically gradients can exist everywhere, they’re often vanishing(zero) at discontinuous points that occur often in these problems, which prohibits any sort of learning via neural networks. Hence, the paper argues that the <strong>Analytic differentiation</strong> strategy, when paired with <strong>Unfolding</strong> can lead to an end-to-end pipeline that supports any solver.</p>
<section id="unfolding-and-unrolling" class="level2">
<h2 class="anchored" data-anchor-id="unfolding-and-unrolling">Unfolding and Unrolling</h2>
<p>Let’s uncover unfolding and unrolling. Unrolling is a simple process of backpropogating the optimization through the computation graph without explicity calculating their jacobians.</p>
</section>
<section id="analytic-differentiation" class="level2">




</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">Analytic Differentiation</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-amos2017optnet" class="csl-entry" role="doc-biblioentry">
Amos, Brandon, and J Zico Kolter. 2017. <span>“Optnet: Differentiable Optimization as a Layer in Neural Networks.”</span> In <em>International Conference on Machine Learning</em>, 136–45. PMLR.
</div>
<div id="ref-donti2021dc3" class="csl-entry" role="doc-biblioentry">
Donti, Priya L, David Rolnick, and J Zico Kolter. 2021. <span>“DC3: A Learning Method for Optimization with Hard Constraints.”</span> <em>arXiv Preprint arXiv:2104.12225</em>.
</div>
<div id="ref-ferber2020mipaal" class="csl-entry" role="doc-biblioentry">
Ferber, Aaron, Bryan Wilder, Bistra Dilkina, and Milind Tambe. 2020. <span>“Mipaal: Mixed Integer Program as a Layer.”</span> In <em>Proceedings of the AAAI Conference on Artificial Intelligence</em>, 34:1504–11. 02.
</div>
<div id="ref-kotary2023folded" class="csl-entry" role="doc-biblioentry">
Kotary, James, My H Dinh, and Ferdinando Fioretto. 2023. <span>“Folded Optimization for End-to-End Model-Based Learning.”</span> <em>arXiv Preprint arXiv:2301.12047</em>.
</div>
<div id="ref-pineda2022theseus" class="csl-entry" role="doc-biblioentry">
Pineda, Luis, Taosha Fan, Maurizio Monge, Shobha Venkataraman, Paloma Sodhi, Ricky Chen, Joseph Ortiz, et al. 2022. <span>“Theseus: A Library for Differentiable Nonlinear Optimization.”</span> <em>arXiv Preprint arXiv:2207.09442</em>.
</div>
<div id="ref-poganvcic2020differentiation" class="csl-entry" role="doc-biblioentry">
Pogančić, Marin Vlastelica, Anselm Paulus, Vit Musil, Georg Martius, and Michal Rolinek. 2020. <span>“Differentiation of Blackbox Combinatorial Solvers.”</span> In <em>International Conference on Learning Representations</em>.
</div>
</div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{balloli2023,
  author = {Vaibhav Balloli},
  title = {Folded {Optimization} for {End-to-End} {Model-Based}
    {Learning:} {A} Summary},
  date = {2023-02-14},
  url = {vballoli.github.io/posts/fold-opt},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-balloli2023" class="csl-entry quarto-appendix-citeas" role="doc-biblioentry">
Vaibhav Balloli. 2023. <span>“Folded Optimization for End-to-End
Model-Based Learning: A Summary.”</span> February 14, 2023. <a href="https://vballoli.github.io/posts/fold-opt">vballoli.github.io/posts/fold-opt</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="vballoli/research-recap" data-repo-id="R_kgDOH0vMDQ" data-category="General" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Copyright 2023, Vaibhav Balloli<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
  </div>
</footer>



</body></html>