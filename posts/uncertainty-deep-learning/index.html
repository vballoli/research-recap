<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Vaibhav Balloli">
<meta name="dcterms.date" content="2023-06-11">

<title>Research Recap - Uncertainty in Deep Learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-35WV1WKM7Q"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-35WV1WKM7Q', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  });
});
</script> 
  

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Research Recap - Uncertainty in Deep Learning">
<meta name="twitter:description" content="With the impressive performance of deep learning, adoption of such models are massive and dependence on them becomes imperative.">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Research Recap</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About Me</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/vballoli"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/v_balloli"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://vballoli.github.io"><i class="bi bi-globe" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://vballoli.com"><i class="bi bi-book" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:balloli.vb@gmail.com"><i class="bi bi-envelope-open" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Uncertainty in Deep Learning</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">uncertainty</div>
                <div class="quarto-category">bias</div>
                <div class="quarto-category">risk</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Vaibhav Balloli </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">June 11, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#uncertainty" id="toc-uncertainty" class="nav-link active" data-scroll-target="#uncertainty">Uncertainty</a>
  <ul class="collapse">
  <li><a href="#aleatoric-uncertainty" id="toc-aleatoric-uncertainty" class="nav-link" data-scroll-target="#aleatoric-uncertainty">Aleatoric Uncertainty</a></li>
  <li><a href="#epistemic-uncertainty" id="toc-epistemic-uncertainty" class="nav-link" data-scroll-target="#epistemic-uncertainty">Epistemic Uncertainty</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p><img src="./uncertainty_meme.JPG" class="img-fluid"></p>
<p>With the impressive performance of deep learning, adoption of such models are massive and dependence on them becomes imperative. This begs the question - how confident are these <em>deep learning models</em> in their predictions / recommendations ? It is clear that the output of these models, without any sense of confidence can quickly be disastrous, depending on the sensitivity and scale of the people impacted. This blog post aims to cover some of these topics - from understanding what it means to predict how confident a model is to other techniques like calibration that is used to <em>tune</em> models to a real-world likelihood.</p>
<section id="uncertainty" class="level1">
<h1>Uncertainty</h1>
<p>The standard view of deep learning models is that their predictions are <em>deterministic</em> i.e.&nbsp;given a model and an input, the prediction is a point estimate that always remains the same <span class="citation" data-cites="gal2016uncertainty">(<a href="#ref-gal2016uncertainty" role="doc-biblioref">Gal et al. 2016</a>)</span>. The certainty about this prediction is surpisingly quite uncommon in standard literature/practice and unavailable in standard SOTA models. But how can this uncertainty help ? Well, it turns out - knowing the uncertainty for any prediction is quite helpful. If the input is out-of-distribution(O.O.D), the model have a high uncertainty output certainly helps identify such inputs and signal that the model is being given something it wasn’t trained to do. Taking a step further, another application of uncertainty includes consulting a human - when a model is unsure about it’s prediction, a rule can certainty be added that defers the prediction to a (expert) human when the model has low confidence or high uncertainty about it’s predictions. There exist many more of these examples, but I hope the importance of uncertainty is well motivated.</p>
<p>Moving on, what are the potential sources for uncertainty?</p>
<ol type="1">
<li>Noisy/Stochastic data(imprecise labels, etc.) - practically no control over the data/task</li>
<li>Unsure about the underlying measurements, inadequate knowledge, etc.</li>
</ol>
<p>These are broadly the sources of uncertainty. All uncertainty arising from noisy data and the inherent stochasticity of the underlying data/task is termed as <strong>Aleatoric Uncertainty</strong> and uncertainty arising from imprecise knowledge is termed as <strong>Epistemic Uncertainty</strong>.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Additional terminology fun <span class="citation" data-cites="gal2016uncertainty">(<a href="#ref-gal2016uncertainty" role="doc-biblioref">Gal et al. 2016</a>)</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The word epistemic comes from “episteme”, Greek for “knowledge”, i.e.&nbsp;epistemic uncertainty is “knowledge uncertainty”. Aleatoric comes from the Latin “aleator”, or “dice player”, i.e.&nbsp;aleatoric uncertainty is the “dice player’s” uncertainty. Epistemic and aleatoric uncertainties are sometimes referred to as reducible and irreducible uncertainties respectively, since epistemic uncertainty can be reduced with more data (knowledge), while aleatoric uncertainty cannot (the stochasticity of a dice roll cannot be reduced by observing more rolls). We will avoid this terminology though, since aleatoric uncertainty can also be seen as “reducible” through an increase in measurement precision, i.e.&nbsp;by changing the underlying system with which we perform the experiment.</p>
</div>
</div>
</div>
<section id="aleatoric-uncertainty" class="level2">
<h2 class="anchored" data-anchor-id="aleatoric-uncertainty">Aleatoric Uncertainty</h2>
<p>Aleatoric Uncertainty simply stated is irreducible uncertainty due to the inherent stochasticity. This section covers calculating Aleatoric Uncertainty through Mean Variance Estimation <span class="citation" data-cites="nix1994estimating">(<a href="#ref-nix1994estimating" role="doc-biblioref">Nix and Weigend 1994</a>)</span>. Given an input <span class="math inline">\(X\)</span>, we’re interested in estimating the (a) <em>conditional mean</em> i.e.&nbsp;<span class="math inline">\(\mu(y\vert x)\)</span> and (b) uncertainty estimate by calculating the <em>variance</em> <span class="math inline">\(\sigma^2(x)\)</span>. Note, both the mean and variance are dependent on the input. By adding an additional layer(with weights $W_{}) that estimates <span class="math inline">\(\sigma^2\)</span>, <span class="math inline">\(\sigma^2(x) = W^T * h + \beta\)</span>, where <span class="math inline">\(\beta\)</span> is the bias. In order to make variance positive, an exponential activation is added in the end <span class="citation" data-cites="nix1994estimating">(<a href="#ref-nix1994estimating" role="doc-biblioref">Nix and Weigend 1994</a>)</span>. Another modern spin on this is using the reparameterization trick <span class="citation" data-cites="kingma2015variational">(<a href="#ref-kingma2015variational" role="doc-biblioref">Kingma, Salimans, and Welling 2015</a>)</span> (see the implementation <a href="https://github.com/vballoli/Ripple/blob/main/ripple/aleatoric.py#L11">here on Ripple</a>), where a random variable <span class="math inline">\(\epsilon\)</span> is introduced to enable backpropogating through a random node.</p>
</section>
<section id="epistemic-uncertainty" class="level2">
<h2 class="anchored" data-anchor-id="epistemic-uncertainty">Epistemic Uncertainty</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./epistemic_uncertainty.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Epistemic Uncertainty. Credit <a href="https://xkcd.com/2440/">XKCD</a> <a href="https://www.explainxkcd.com/wiki/index.php/2440:_Epistemic_Uncertainty">XKCD Wiki</a></figcaption><p></p>
</figure>
</div>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-gal2016uncertainty" class="csl-entry" role="doc-biblioentry">
Gal, Yarin et al. 2016. <span>“Uncertainty in Deep Learning.”</span>
</div>
<div id="ref-kingma2015variational" class="csl-entry" role="doc-biblioentry">
Kingma, Durk P, Tim Salimans, and Max Welling. 2015. <span>“Variational Dropout and the Local Reparameterization Trick.”</span> <em>Advances in Neural Information Processing Systems</em> 28.
</div>
<div id="ref-nix1994estimating" class="csl-entry" role="doc-biblioentry">
Nix, David A, and Andreas S Weigend. 1994. <span>“Estimating the Mean and Variance of the Target Probability Distribution.”</span> In <em>Proceedings of 1994 Ieee International Conference on Neural Networks (ICNN’94)</em>, 1:55–60. IEEE.
</div>
</div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{balloli2023,
  author = {Vaibhav Balloli},
  title = {Uncertainty in {Deep} {Learning}},
  date = {2023-06-11},
  url = {https://vballoli.github.io/research-recap/posts/uncertainty-deep-learning},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-balloli2023" class="csl-entry quarto-appendix-citeas" role="doc-biblioentry">
Vaibhav Balloli. 2023. <span>“Uncertainty in Deep Learning.”</span> June
11, 2023. <a href="https://vballoli.github.io/research-recap/posts/uncertainty-deep-learning">https://vballoli.github.io/research-recap/posts/uncertainty-deep-learning</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Copyright 2023, Vaibhav Balloli<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
  </div>
</footer>



</body></html>